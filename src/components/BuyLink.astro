---
interface Props {
  href: string
  class?: string
  size?: 'sm' | 'md' | 'lg'
  color?: 'brown' | 'beige-dark'
}

const {
  href,
  class: className = '',
  size = 'lg',
  color = 'brown',
} = Astro.props

// サイズに応じたクラスを定義
const sizeClasses = {
  sm: 'text-[1.25vw]',
  md: 'text-lg',
  lg: 'text-[6.4vw] md:text-[2.2vw]',
}

const svgSizeClasses = {
  sm: 'h-2.5 w-[150%]',
  md: 'h-4 w-[140%]',
  lg: 'h-4 w-[150%] md:h-5',
}

// カラーに応じたクラスを定義
const colorClasses = {
  brown: 'text-brown stroke-brown',
  'beige-dark': 'text-beige-dark stroke-beige-dark',
}
---

<a
  href={href}
  target="_blank"
  rel="noopener noreferrer"
  class:list={[
    'buy-link inline-block hover:no-underline transition-all font-extralight relative',
    sizeClasses[size],
    colorClasses[color],
    className,
  ]}
>
  <span class="buy-text relative z-10 inline-block">BUY</span>
  <svg
    class:list={[
      'buy-link-svg absolute left-1/2 -translate-x-1/2 -bottom-1',
      svgSizeClasses[size],
    ]}
    viewBox="0 0 92 12"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      class="buy-link-path"
      d="M0.23999 11.4C7.38999 7.54997 15.36 5.20997 23.46 4.58997C24.96 4.47997 26.7 4.51997 27.64 5.69997C28.21 6.41997 28.33 7.38997 28.72 8.21997C29.55 9.95997 31.56 10.88 33.49 10.95C35.42 11.02 37.29 10.4 39.11 9.78997C42.61 8.61997 46.1 7.43997 49.6 6.26997C50.67 5.90997 51.77 5.54997 52.89 5.61997C54.01 5.68997 55.18 6.28997 55.57 7.34997C55.85 8.10997 55.7 8.97997 55.99 9.73997C56.39 10.78 57.55 11.37 58.67 11.43C59.79 11.48 60.87 11.11 61.93 10.74C71.66 7.31997 81.39 3.88997 91.11 0.469971"
      stroke="currentColor"
      stroke-miterlimit="10"
      stroke-dasharray="200"
      stroke-dashoffset="0"></path>
  </svg>
</a>

<style>
  /* 初期状態：線が表示されている */
  .buy-link-path {
    transition:
      stroke-dashoffset 0.8s ease-in-out,
      opacity 0.1s ease-in-out;
  }

  /* BUYテキストのシェイクアニメーション */
  .buy-text {
    transform-origin: center bottom;
    transition: transform 0.3s ease;
  }

  /* ホバー時のアニメーション */
  .buy-link:hover .buy-link-path {
    animation: drawLine 1.2s ease-in-out;
  }

  .buy-link:hover .buy-text {
    animation: textShake 1.2s ease-in-out;
  }

  @keyframes drawLine {
    0% {
      stroke-dashoffset: 0;
      opacity: 1;
    }
    10% {
      stroke-dashoffset: 0;
      opacity: 0;
    }
    20% {
      stroke-dashoffset: 200;
      opacity: 0;
    }
    30% {
      stroke-dashoffset: 200;
      opacity: 1;
    }
    100% {
      stroke-dashoffset: 0;
      opacity: 1;
    }
  }

  @keyframes textShake {
    0% {
      transform: rotateZ(0);
    }
    10% {
      transform: rotateZ(-8deg);
    }
    20% {
      transform: rotateZ(4deg);
    }
    30% {
      transform: rotateZ(-2.67deg);
    }
    40% {
      transform: rotateZ(2deg);
    }
    50% {
      transform: rotateZ(-1.6deg);
    }
    60% {
      transform: rotateZ(1.33deg);
    }
    70% {
      transform: rotateZ(-1.14deg);
    }
    80% {
      transform: rotateZ(1deg);
    }
    90% {
      transform: rotateZ(-0.89deg);
    }
    100% {
      transform: rotateZ(0);
    }
  }
</style>
