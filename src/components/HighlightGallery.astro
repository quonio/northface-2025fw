---
import { Image } from 'astro:assets';
import style01 from '@/assets/images/img-style-01.jpg';
import style02 from '@/assets/images/img-style-02.jpg';
import style03 from '@/assets/images/img-style-03.jpg';
import style04 from '@/assets/images/img-style-04.jpg';
import style05 from '@/assets/images/img-style-05.jpg';
import style06 from '@/assets/images/img-style-06.jpg';

interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<section class={`py-16 md:py-24 lg:py-32 ${className}`}>
  <div class="container mx-auto px-4">
    <!-- First 3 images -->
    <div class="mb-16 grid grid-cols-1 gap-4 md:mb-24 md:grid-cols-3 md:gap-6 lg:gap-8">
      <div class="gallery-item aspect-[3/4] overflow-hidden">
        <Image
          src={style01}
          alt="THE NORTH FACE MATERNITY+ Style 1"
          widths={[390, 500, 600]}
          sizes="(max-width: 768px) 100vw, 33vw"
          loading="lazy"
          class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
        />
      </div>
      <div class="gallery-item aspect-[3/4] overflow-hidden">
        <Image
          src={style02}
          alt="THE NORTH FACE MATERNITY+ Style 2"
          widths={[390, 500, 600]}
          sizes="(max-width: 768px) 100vw, 33vw"
          loading="lazy"
          class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
        />
      </div>
      <div class="gallery-item aspect-[3/4] overflow-hidden">
        <Image
          src={style03}
          alt="THE NORTH FACE MATERNITY+ Style 3"
          widths={[390, 500, 600]}
          sizes="(max-width: 768px) 100vw, 33vw"
          loading="lazy"
          class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
        />
      </div>
    </div>

    <!-- Title Section -->
    <div class="mb-16 text-center md:mb-24">
      <h2 class="font-display text-navy text-3xl font-medium md:text-4xl lg:text-5xl">
        THE NORTH FACE MATERNITY+
      </h2>
    </div>

    <!-- Second 3 images -->
    <div class="mb-16 grid grid-cols-1 gap-4 md:mb-24 md:grid-cols-3 md:gap-6 lg:gap-8">
      <div class="gallery-item aspect-[3/4] overflow-hidden">
        <Image
          src={style04}
          alt="THE NORTH FACE MATERNITY+ Style 4"
          widths={[390, 500, 600]}
          sizes="(max-width: 768px) 100vw, 33vw"
          loading="lazy"
          class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
        />
      </div>
      <div class="gallery-item aspect-[3/4] overflow-hidden">
        <Image
          src={style05}
          alt="THE NORTH FACE MATERNITY+ Style 5"
          widths={[390, 500, 600]}
          sizes="(max-width: 768px) 100vw, 33vw"
          loading="lazy"
          class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
        />
      </div>
      <div class="gallery-item aspect-[3/4] overflow-hidden">
        <Image
          src={style06}
          alt="THE NORTH FACE MATERNITY+ Style 6"
          widths={[390, 500, 600]}
          sizes="(max-width: 768px) 100vw, 33vw"
          loading="lazy"
          class="h-full w-full object-cover transition-transform duration-500 hover:scale-105"
        />
      </div>
    </div>

    <!-- Description Text -->
    <div class="mx-auto max-w-4xl">
      <p class="text-navy text-center text-base leading-relaxed md:text-lg lg:text-xl">
        THE NORTH FACEã®MATERNITY+ã¯ã€æŒ‘æˆ¦ã‚„å¤‰åŒ–ã«ç«‹ã¡å‘ã‹ã†ã“ã¨ã‚’æ¥½ã—ã‚€ãŸã‚ã®ã‚¢ã‚¤ãƒ†ãƒ ãƒ©ã‚¤ãƒ³ã§ã™ã€‚<br
        />
        æ€§åˆ¥ã‚’å•ã‚ãšè‚²å…ã‚’ã™ã‚‹äººã®è² æ‹…ã‚’è»½æ¸›ã—ã€å­ã©ã‚‚ã®æˆé•·ã¨ã¨ã‚‚ã«å¤‰åŒ–ã‚’æ¥½ã—ã¿ã€<br
          class="hidden md:block"
        />
        é•·ãæ„›ç€ã‚’æŒã¤ã“ã¨ãŒã§ãã‚‹ã‚¦ã‚¨ã‚¢ã‚’å–ã‚Šæƒãˆã¦ã„ã¾ã™ã€‚<br />
        MATERNITY+ã¯ã€ã€Œå¦Šå¨ ãƒ»å‡ºç”£ã‚„å­è‚²ã¦ã‚’çµŒé¨“ã™ã‚‹å®¶æ—ã€ã®EXPLORATIONã‚’å¶ãˆã‚‹ã‚«ãƒ†ã‚´ãƒªãƒ¼ã¨ã—ã¦ã€<br
          class="hidden md:block"
        />
        è‚²å…ã‚’ã™ã‚‹ã²ã¨ã‚’æ€§åˆ¥ã‚’å•ã‚ãšã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
      </p>
    </div>
  </div>
</section>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  // Register ScrollTrigger plugin
  gsap.registerPlugin(ScrollTrigger);

  function initBasicGSAPTest() {
    console.log('ğŸš€ GSAP Test Starting');
    console.log('GSAP version:', gsap.version);
    console.log('ScrollTrigger available:', !!ScrollTrigger);

    // å…¨ã¦ã®ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ã®åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
    const allGalleryItems = document.querySelectorAll('.gallery-item');
    allGalleryItems.forEach((item, index) => {
      gsap.set(item, {
        x: index % 2 === 0 ? -200 : 200,
        opacity: 0,
        scale: 0.8
      });
    });

    // æœ€åˆã®3ã¤ã®ç”»åƒç”¨ã®ScrollTrigger
    const firstGallerySection = document.querySelectorAll('.grid')[0];
    if (firstGallerySection) {
      ScrollTrigger.create({
        trigger: firstGallerySection,
        start: 'top 80%',
        end: 'bottom 20%',
        markers: true, // ãƒ‡ãƒãƒƒã‚°ãƒãƒ¼ã‚«ãƒ¼
        onEnter: () => {
          console.log('ğŸ“ First Gallery ScrollTrigger: onEnter');
          // æœ€åˆã®3ã¤ã®ç”»åƒã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
          const firstThreeItems = firstGallerySection.querySelectorAll('.gallery-item');
          gsap.to(firstThreeItems, {
            x: 0,
            opacity: 1,
            scale: 1,
            duration: 1.2,
            stagger: 0.15,
            ease: 'power3.out',
          });
        },
        onLeave: () => console.log('ğŸ“ First Gallery ScrollTrigger: onLeave'),
        onEnterBack: () => console.log('ğŸ“ First Gallery ScrollTrigger: onEnterBack'),
        onLeaveBack: () => console.log('ğŸ“ First Gallery ScrollTrigger: onLeaveBack'),
      });
    }

    // ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    const testElement = document.querySelector('.text-center h2');
    if (testElement) {
      console.log('âœ… Test element found:', testElement);

      // ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
      gsap.from(testElement, {
        duration: 2,
        y: 50,
        opacity: 0,
        ease: 'bounce.out',
        onComplete: () => {
          console.log('ğŸ‰ Basic animation completed!');
        },
      });
    }

    // 2ç•ªç›®ã®3ã¤ã®ç”»åƒç”¨ã®ScrollTrigger
    const secondGallerySection = document.querySelectorAll('.grid')[1];
    if (secondGallerySection) {
      ScrollTrigger.create({
        trigger: secondGallerySection,
        start: 'top 80%',
        end: 'bottom 20%',
        markers: true, // ãƒ‡ãƒãƒƒã‚°ãƒãƒ¼ã‚«ãƒ¼
        onEnter: () => {
          console.log('ğŸ“ Second Gallery ScrollTrigger: onEnter');
          // 2ç•ªç›®ã®3ã¤ã®ç”»åƒã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
          const secondThreeItems = secondGallerySection.querySelectorAll('.gallery-item');
          gsap.to(secondThreeItems, {
            x: 0,
            opacity: 1,
            scale: 1,
            duration: 1.2,
            stagger: 0.15,
            ease: 'power3.out',
          });
        },
        onLeave: () => console.log('ğŸ“ Second Gallery ScrollTrigger: onLeave'),
        onEnterBack: () => console.log('ğŸ“ Second Gallery ScrollTrigger: onEnterBack'),
        onLeaveBack: () => console.log('ğŸ“ Second Gallery ScrollTrigger: onLeaveBack'),
        onUpdate: (self) => console.log('ğŸ“Š ScrollTrigger progress:', self.progress.toFixed(2)),
      });
    }

    // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’è¡¨ç¤ºï¼ˆChromeé™å®šï¼‰
    const memoryInfo = (performance as any).memory;
    if (memoryInfo) {
      console.log('ğŸ’¾ Memory usage:', {
        used: Math.round(memoryInfo.usedJSHeapSize / 1024 / 1024) + ' MB',
        total: Math.round(memoryInfo.totalJSHeapSize / 1024 / 1024) + ' MB',
        limit: Math.round(memoryInfo.jsHeapSizeLimit / 1024 / 1024) + ' MB',
      });
    } else {
      console.log('ğŸ’¾ Memory API not available (Chrome only)');
    }
  }

  // åˆæœŸåŒ–
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ“„ DOM loaded, starting GSAP test in 500ms...');
      setTimeout(initBasicGSAPTest, 500);
    });
  } else {
    console.log('ğŸ“„ DOM ready, starting GSAP test in 500ms...');
    setTimeout(initBasicGSAPTest, 500);
  }

  // Astro page transitions
  document.addEventListener('astro:page-load', () => {
    console.log('ğŸ”„ Astro page loaded, restarting GSAP test...');
    setTimeout(initBasicGSAPTest, 500);
  });
</script>
